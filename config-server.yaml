---
- name: Configure Windows Host and Install Applications
  hosts: windows
  tasks:
    - name: Ensure Chocolatey is installed
      win_chocolatey_facts:

    - name: Install Chocolatey
      win_command: |
        @"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))"
      args:
        creates: C:\ProgramData\chocolatey

    - name: Install Google Chrome
      win_chocolatey:
        name: googlechrome
        state: present

    - name: Install Notepad++
      win_chocolatey:
        name: notepadplusplus
        state: present

    - name: Install Git
      win_chocolatey:
        name: git
        state: present

    - name: Ensure Chocolatey is up to date
      win_chocolatey:
        name: chocolatey
        state: latest

    - name: Install SNMP feature using PowerShell
      win_shell: |
        Add-WindowsCapability -Online -Name "SNMP.Client~~~~0.0.1.0"
      when: ansible_os_family == "Windows"

    - name: Install SNMP WMI Provider feature using PowerShell
      win_shell: |
        Add-WindowsCapability -Name SNMP-WMI-Provider
      when: ansible_os_family == "Windows"
